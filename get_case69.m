function case69 = get_case69()
% GET_CASE69 Returns the IEEE 69-bus system data.
%
% This function performs the critical conversion from OHMS to PER-UNIT
% based on the standard IEEE 69 constants provided in the source code.
%
% Constants:
%   Base MVA: 10 MVA
%   Base kV:  12.66 kV
%   Z_base:   16.027 Ohms
%
% Returns:
%   case69.branch: [From, To, R(pu), X(pu)]
%   case69.baseMVA: 10
%   case69.baseKV: 12.66

    case69.baseMVA = 10;   % System Base MVA
    case69.baseKV = 12.66; % System Base Voltage (kV)

    % =====================================================================
    % 1. RAW BRANCH DATA (Values in OHMS)
    % Cols: [From, To, R(ohm), X(ohm)]
    % Source: Baran and Wu (1989) / Standard IEEE 69 Data
    % =====================================================================
    branch_ohms = [
        1   2   0.0005  0.0012;
        2   3   0.0005  0.0012;
        3   4   0.0015  0.0036;
        4   5   0.0251  0.0294;
        5   6   0.3660  0.1864;
        6   7   0.3811  0.1941;
        7   8   0.0922  0.0470;
        8   9   0.0493  0.0251;
        9   10  0.8190  0.2707;
        10  11  0.1872  0.0619;
        11  12  0.7114  0.2351;
        12  13  1.0300  0.3400;
        13  14  1.0440  0.3450;
        14  15  1.0580  0.3496;
        15  16  0.1966  0.0650;
        16  17  0.3744  0.1238;
        17  18  0.0047  0.0016;
        18  19  0.3276  0.1083;
        19  20  0.2106  0.0690;
        20  21  0.3416  0.1129;
        21  22  0.0140  0.0046;
        22  23  0.1591  0.0526;
        23  24  0.3463  0.1145;
        24  25  0.7488  0.2475;
        25  26  0.3089  0.1021;
        26  27  0.1732  0.0572;
        3   28  0.0044  0.0108;
        28  29  0.0640  0.1565;
        29  30  0.3978  0.1315;
        30  31  0.0702  0.0232;
        31  32  0.3510  0.1160;
        32  33  0.8390  0.2816;
        33  34  1.7080  0.5646;
        34  35  1.4740  0.4873;
        3   36  0.0044  0.0108;
        36  37  0.0640  0.1565;
        37  38  0.1053  0.1230;
        38  39  0.0304  0.0355;
        39  40  0.0018  0.0021;
        40  41  0.7283  0.8509;
        41  42  0.3100  0.3623;
        42  43  0.0410  0.0478;
        43  44  0.0092  0.0116;
        44  45  0.1089  0.1373;
        45  46  0.0009  0.0012;
        4   47  0.0034  0.0084;
        47  48  0.0851  0.2083;
        48  49  0.2898  0.7091;
        49  50  0.0822  0.2011;
        8   51  0.0928  0.0473;
        51  52  0.3319  0.1140;
        9   53  0.1740  0.0886;
        53  54  0.2030  0.1034;
        54  55  0.2842  0.1447;
        55  56  0.2813  0.1433;
        56  57  1.5900  0.5337;
        57  58  0.7837  0.2630;
        58  59  0.3042  0.1006;
        59  60  0.3861  0.1172;
        60  61  0.5075  0.2585;
        61  62  0.0974  0.0496;
        62  63  0.1450  0.0738;
        63  64  0.7105  0.3619;
        64  65  1.0410  0.5302;
        11  66  0.2012  0.0611;
        66  67  0.0047  0.0014;
        12  68  0.7394  0.2444;
        68  69  0.0047  0.0016;
    ];

    % =====================================================================
    % 2. CONVERSION: OHMS -> PER UNIT
    % Formula: Z_pu = Z_ohm / Z_base
    % Z_base = (V_base_kV^2) / S_base_MVA
    % =====================================================================
    
    % Calculate Base Impedance
    Zbase = (case69.baseKV^2) / case69.baseMVA; % (12.66^2)/10 = 16.027 Ohm
    
    % Perform conversion
    branch_pu = branch_ohms;
    branch_pu(:, 3) = branch_ohms(:, 3) / Zbase; % R conversion
    branch_pu(:, 4) = branch_ohms(:, 4) / Zbase; % X conversion
    
    case69.branch = branch_pu;

end